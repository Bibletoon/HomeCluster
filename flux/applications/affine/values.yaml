applicationName: "affine"
deployment:
    enabled: true
    initContainers:
        affine_migration_job:
          image: 'ghcr.io/toeverything/affine-graphql:stable'
          command: ['sh', '-c', 'node ./scripts/self-host-predeploy.js']
    envFrom:
        - type: secret
          name: affine-config
    volumes:
        affine-storage:
          persistenceVolumeClaim:
            claimName: affine-storage
        affine-config:
          persistenceVolumeClaim:
            claimName: affine-config
    volumeMounts:
        affine-storage:
          mountPath: /root/.affine/storage
          subPath: storage
        affine-config:
          mountPath: /root/.affine/config
          subPath: config
    image:
        repository: ghcr.io/toeverything/affine-graphql
        tag: stable
    containerSecurityContext:
        readOnlyRootFilesystem: true
        runAsNonRoot: false
service:
    enabled: true
    ports:
        - name: http
          port: 3100
          protocol: TCP
          targetPort: 3100
ingress:
    enabled: true
    ingressClassName: traefik
    hosts:
        - host: affine.bibletoon.xyz
          paths:
              - path: /